---
title: | 
  <center> COVID-19 COMUNA
author: " <center> EJA"
date: " <center> 20-04-2020"
output:
  html_document:
    df_print: paged
    highlight: pygments
    theme: darkly
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages(c("varhandle","reshape2","ggplot2","readr"))
library(readr)
library(varhandle)
library(reshape2)
library(ggplot2)
library(stargazer)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <https://github.com/LeerySpice/Covid-19-Chile>.

## Código en R

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r, message=FALSE}
confirmados_comunas <- read_csv("https://raw.githubusercontent.com/jorgeperezrojas/covid19-data/master/csv/confirmados_comunas.csv")

index <- which(confirmados_comunas$codigo_region==13)
RMC <- as.data.frame(t(confirmados_comunas[index, ]))
names(RMC) <- lapply(RMC[4, ], as.character)
RMC <- RMC[-1:-4,]

RMC$date <- substr(rownames(RMC), start = 1, stop = 5)
rownames(RMC) <- c()
RMC <- unfactor(RMC)
RMC[,][RMC[,] == "-"] <- as.numeric(0)
RMC <- unfactor(RMC)
RMC$date <- as.Date(RMC$date, "%m/%d")

```

### Including Plots

You can also embed plots, for example:

```{r}
RMC.long <- melt(RMC, id = "date", measure = c("La Florida", "Vitacura", "Puente Alto", "Lo Barnechea", "Maipú", "Las Condes", "Ñuñoa", "Providencia","Santiago"))
ggplot(data = RMC.long, aes(date, value, colour = variable)) +  geom_line() + theme(axis.text.x = element_text(angle=65, hjust=1, vjust = 1)) 
```


### Comunas con mayor contagio

```{r echo=TRUE, results = "asis"}
index <- order(as.numeric(t(RMC[,-53])[,9]), decreasing = TRUE, na.last = FALSE)
knitr::kable(head(t(RMC)[index,9]), caption = "Últimos datos")
```

```{r results = "asis"}
stargazer::stargazer(RMC, type = "html",
 title = "Table with stargazer")
```


